<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> Automatic System </title>
	{% load staticfiles %}

	<link rel="shortcut icon" href="{% static 'res/favicon.ico'%}">
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/font-awesome.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/nprogress.css' %}" rel="stylesheet">
    <!-- <link href="{% static 'css/custom.min.css' %}" rel="stylesheet"> -->
	<link href="{% static 'css/bootstrap-table.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/select2.min.css' %}" rel="stylesheet">
	<link href="{% static 'css/jquery-editable-select.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/my.css' %}" rel="stylesheet">
    <!-- jquery -->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/jquery-editable-select.min.js' %}"></script>
    <script src="{% static 'js/select2.min.js' %}"></script>

	<!--[if lt IE 9]>
	<script src="assets/js/ie8-responsive-file-warning.js"></script>
	<![endif]-->

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
	  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

    <style>
        .form-control {
            -webkit-box-shadow:inset 0 0 0 rgba(0,0,0,.075);
            box-shadow:inset 0 0 0 rgba(0,0,0,.075);
        }
        input, select, textarea, .input-sm {
            border-bottom: 1px solid #878787;
            border-top:0px;
            border-left:0px;
            border-right:0px;
        }
        .table>tbody>tr>td, .table>tbody>tr>th, .table>tfoot>tr>td, .table>tfoot>tr>th, .table>thead>tr>td, .table>thead>tr>th {
            border-top: 0px;
        }
        .ztbtn {
            background-color:#114f8e;
            color:#fff;
        }
    </style>
  </head>

  <body>
    <div class="row" style='margin:20px'>
        <div class="panel panel-default">
            <div class="panel-heading"> 用例版本确认 </div>
            <div class="panel-body">
                <div class='alert alert-warning alert-dismissible ztbtn'>[!] 先确认用例版本和平台</div>
                <form class="form-horizontal">
                    <div class="form-group">
                        <label for="version" class="col-sm-2 control-label">用例版本</label>
                        <div class="col-sm-6">
                            <select class="form-control input-sm" id='version'>
                                {% for x in versionList %}
                                <option {% if x == case.version %}selected{% endif %}>{{ x }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <!-- 平台 -->
                    <div class="form-group">
                        <label for="platform" class="col-sm-2 control-label">平台 <strong class="text-danger">*</strong> </label>
                        <div class="col-sm-10">
                            {% for x in plant %}
                            <label class="radio-inline">
                              <input type="radio" name="platRadio" id="platform" {% if x == case.plantform %}checked="True"{% endif %} value="{{ x }}"> {{ x }}
                            </label>
                            {% endfor %}
                            <span id="helpBlock" class="help-block">iOS比较特殊, 和AD M站用例不通用, 故iOS用例不要改成AD或M站版本</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <a type="submit" class="btn btn-sm ztbtn" id='verConfirm'>版本确认</a>
                            <a type="submit" class="btn btn-default btn-sm" href='/auto/'>返回</a>
                        </div>
                    </div>
                </form>
                <div id='downTap'>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="copyModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title"> 用例复制 </h4>
                </div>
                <div class="modal-body">
                    <h3>Are You Sure?</h3>
                    <div id='copymess' class="alert" style="display:none"></div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn ztbtn" id='makeSure' name="copyThis"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span> 提交</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span> 返回</button>
                </div>
            </div>
        </div>
    </div>

	<script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/bootstrap-table-editable.js' %}"></script>
    <script src="{% static 'js/bootstrap-editable.js' %}"></script>
    <script src="{% static 'js/nprogress.js' %}"></script>
    <script src="{% static 'js/custom.min.js' %}"></script>
	<script>
        // Modal 模板
        $(document).ready(function(){
            $('#copyModal').on('show.bs.modal', function (e) {
                var btn = $(e.relatedTarget),
                    id = btn.data("index");
                $(this).find('[name="copyThis"]').click(function(){
                    $.get("/auto/auto_copy",{'id':id}, function(data,status){
                        $('#copymess').text(data);
                    });
                    $('#copymess').css('display','block');
                });
            });

            $('#copyModal').on('hide.bs.modal', function (){
                // window.location.reload();
                $("#Search").click()
            });
        });

        // 初始化select2
        $(".selectMulti").select2();

        // 取消订单
        $('#cancleOrder').click(function(){
            alert('请求已经提交, 但由于取消订单接口较慢, 需耐心等待')
            $.getJSON('/auto/cancleOrder',function(data){
                alert(data.content)
            })
        })

        $.ajaxSetup({
            data: {csrfmiddlewaretoken: '{{ csrf_token }}' },
        });
    </script>

    <script>
      $(document).ready(function(){
          $("#verConfirm").click(function(){
              var caseID = {{ id | safe }}
              if ($("#version").val()){
                  version = $("#version").val();
                  platform = $("#platform:checked").val();
              }else{
                  version = null
              };
              var isN = '{{isNew|safe}}'
              $.get("{% url 'editCaseStep' %}",{'caseID':caseID,'version':version,'platform':platform,'isNew':isN}, function(ret){
                  $("#downTap").html(ret)
              })
          });
      });
    </script>
    </body>
</html>
